<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../lib/bootswatch/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
    <title>New category</title>
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
                <div class="row py-5">
                    <form method="post" id="form">
                        <label class="form-label">Category name:</label>
                        <input type="text" class="form-control rounded" id="categoryName" />
                        <span id="validation" class="text-danger"></span><br />
                        <button type="submit" class="btn btn-outline-primary rounded offset-10">Submit</button>
                    </form>
                </div>
            </div>
            <div class="col-md-3"></div>
        </div>
    </div>
</body>
</html>

<script src="../lib/jquery/dist/jquery.min.js"></script>
<script src="../lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="../js/site.js" asp-append-version="true"></script>
<script>
    class Category {
        constructor(){
            this.Name;
		}
    }
    document.addEventListener('DOMContentLoaded', () => {

        const category = new Category();
        const CategoryForm = document.querySelector('#form');
        const elements = CategoryForm.elements;

        CategoryForm.addEventListener('submit', (e) => {

            e.preventDefault();
            e.stopPropagation();

            category.Name = elements.categoryName.value;
            console.log(category);

            if (ValidateInput()) {
                Create(category);
            }
        });       
    })

    function Create(category) {       
		debugger;
		return fetch("https://localhost:44363/categories/", {
			headers: {
				'Content-type': 'application/json'
			},
			body: JSON.stringify(category),
			method: 'POST'
        }).then((response) => 		
            response.json()
        ).then((json) =>
            alert(`Success: ${JSON.stringify(json)}  was created`))      
    }
	
    function ValidateInput() {
        let inputName = document.querySelector('#categoryName');
        let alerta = document.querySelector('#validation');

		if (inputName.value === "") {            
            alerta.innerHTML = 'Category name is required!';
            return false;
        }
		
		if (parseInt(inputName.value)) {
            alerta.innerHTML = 'Ivalid category name!, only letters are allowed...';
			return false;
        }
        inputName = "";
		alerta.innerHTML = "";
        return true;
	}

    
</script>